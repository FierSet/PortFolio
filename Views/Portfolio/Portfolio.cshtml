<div class="element-center">

    <div class="main-content">

        <nav class="navbar-card" id="navbar-card">
            <partial name="_navbarcard" model=Model />
        </nav>

        <div class="info-card" id="partialContainer">
            <partial name="./sheets/@Model.SelectedPartial" model=Model.PortFolioModel/>
        </div>

        <script>
            function bindLoadPartialLinks() {
                document.querySelectorAll(".load-partial").forEach(function(link) 
                {
                    // Remove previous click handlers if needed (optional)
                    link.removeEventListener("click", handlePartialClick);
                    link.addEventListener("click", handlePartialClick);
                });
            }

            function handlePartialClick(event) 
            {
                event.preventDefault();

                const partialName = this.getAttribute("data-partial");
                // Load partial view
                fetch(`/Portfolio/ChangePartialView?PartialName=${partialName}`)
                    .then(response => response.text())
                    .then(html => {
                        document.getElementById("partialContainer").innerHTML = html;
                        bindLoadPartialLinks(); // Rebind after DOM update
                    }).catch(err => console.error("Error loading partial:", err));;
                // Load navbar card
                fetch(`/Portfolio/GetNavbarCard?PartialName=${partialName}`)
                    .then(response => response.text())
                    .then(navHtml => {
                        document.getElementById("navbar-card").innerHTML = navHtml;
                        bindLoadPartialLinks(); // Rebind again if navbar has links
                    }).catch(err => console.error("Error loading partial:", err));;
            }
            // Initial binding on page load
            document.addEventListener("DOMContentLoaded", bindLoadPartialLinks);
        </script>

    </div>

    <div class="user-card">
        <div class="avatar-zone">
            <img class="avatar" src="@Model.PortFolioModel.Contacts[0].Img" alt="Portfolio Image" class="img-fluid" />
            <div class="name-prof">
                <p class = "name">@Model.PortFolioModel.Contacts[0].Name</p>
                <p class="profession">@Model.PortFolioModel.Contacts[0].Profession</p>
            </div>

            <div class="contact-zone">

                <div class="infocontact">
                    <i class="hgi hgi-stroke hgi-mail-01 icon-avatar"></i>
                    <div class="contact-text">
                        <p class="label-contact">Email</p>
                        <a class="label-contact-value" href="mailto:@Model.PortFolioModel.Contacts[0].Email">@Model.PortFolioModel.Contacts[0].Email</a>
                    </div>
                </div>

                <div class="infocontact">
                    <i class="hgi hgi-stroke hgi-location-03 icon-avatar"></i>
                    <div class="contact-text">
                        <p class="label-contact">Location</p>
                        <a class="label-contact-value">@Model.PortFolioModel.Contacts[0].Location</a>
                    </div>
                </div>

            </div>

            <div class="lick-social">
                @foreach(var link in Model.PortFolioModel.Links_social)
                {
                    <a class="social-link-icon" href="@link.Link" target="_blank"> 
                        <i class="@(link.Name != "Main web" ? "fa-brands fa-" + link.Name.ToLower().Replace(" ", "") : "fa-solid fa-globe")"></i> 
                    </a>
                }
            </div>

        </div>
        <hr/>
    </div>
    
</div>