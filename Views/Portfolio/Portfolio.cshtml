@{
    ViewData["Title"] = "Home Page";
}

<div class="element-center">

    <div class="main-content">

        <nav class="navbar-card" id="navbar-card">
            <partial name="_navbarcard" model=Model />
        </nav>

        <div class="info-card" id="partialContainer">
            <partial name="sheets/@Model.SelectedPartial" model=Model.PortFolioModel/>
        </div>

        <script>
            function bindLoadPartialLinks() {
                document.querySelectorAll(".load-partial").forEach(function(link) {
                    // Remove previous click handlers if needed (optional)
                    link.removeEventListener("click", handlePartialClick);
                    link.addEventListener("click", handlePartialClick);
                });
            }

            function handlePartialClick(event) {
                event.preventDefault();

                const partialName = this.getAttribute("data-partial");
                // Load partial view
                fetch(`/Portfolio/ChangePartialView?PartialName=${partialName}`)
                    .then(response => response.text())
                    .then(html => {
                        document.getElementById("partialContainer").innerHTML = html;
                        bindLoadPartialLinks(); // Rebind after DOM update
                    }).catch(err => console.error("Error loading partial:", err));;
                // Load navbar card
                fetch(`/Portfolio/GetNavbarCard?PartialName=${partialName}`)
                    .then(response => response.text())
                    .then(navHtml => {
                        document.getElementById("navbar-card").innerHTML = navHtml;
                        bindLoadPartialLinks(); // Rebind again if navbar has links
                    }).catch(err => console.error("Error loading partial:", err));;
            }
            // Initial binding on page load
            document.addEventListener("DOMContentLoaded", bindLoadPartialLinks);
        </script>
    </div>

    <aside class="user-card">
        <div class="avatar-zone">
            <img class="avatar" src="@Model.PortFolioModel.Contacts[0].Img" alt="Portfolio Image" class="img-fluid" />
            <div class="name-prof">
                <p class = "name">@Model.PortFolioModel.Contacts[0].Name</p>
                <p class="profession">@Model.PortFolioModel.Contacts[0].Profession</p>
            </div
        </div>
        <hr/>
    </aside>
    
</div>